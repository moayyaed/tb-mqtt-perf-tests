To configure test-run properties:

```
kubectl apply -f tb-broker-namespace.yml
kubectl apply -f mqtt-broker-test-run-config.yml
kubectl apply -f mqtt-broker-orch-config.yml
```

To set up test pods:

```
kubectl apply -f broker-tests.yml
kubectl rollout status statefulset/broker-tests
```

To run tests:
**Note:** you have to run `kubectl exec ...` command for every broker-tests pod.

**1** Test Pod:

```
kubectl exec broker-tests-0 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-0.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=0;export TEST_RUN_PARALLEL_TESTS_COUNT=1;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-0.log 2>&1 &
```

**2** Test Pods:

```
kubectl exec broker-tests-0 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-0.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=0;export TEST_RUN_PARALLEL_TESTS_COUNT=2;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-0.log 2>&1 &
kubectl exec broker-tests-1 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-1.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=1;export TEST_RUN_PARALLEL_TESTS_COUNT=2;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-1.log 2>&1 &
```

**5** Test Pods:

```
kubectl exec broker-tests-0 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-0.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=0;export TEST_RUN_PARALLEL_TESTS_COUNT=5;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-0.log 2>&1 &
kubectl exec broker-tests-1 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-1.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=1;export TEST_RUN_PARALLEL_TESTS_COUNT=5;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-1.log 2>&1 &
kubectl exec broker-tests-2 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-2.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=2;export TEST_RUN_PARALLEL_TESTS_COUNT=5;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-2.log 2>&1 &
kubectl exec broker-tests-3 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-3.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=3;export TEST_RUN_PARALLEL_TESTS_COUNT=5;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-3.log 2>&1 &
kubectl exec broker-tests-4 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-4.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=4;export TEST_RUN_PARALLEL_TESTS_COUNT=5;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-4.log 2>&1 &
```

**40** Test Pods:

```
kubectl exec broker-tests-0 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-0.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=0;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-0.log 2>&1 &
kubectl exec broker-tests-1 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-1.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=1;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-1.log 2>&1 &
kubectl exec broker-tests-2 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-2.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=2;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-2.log 2>&1 &
kubectl exec broker-tests-3 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-3.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=3;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-3.log 2>&1 &
kubectl exec broker-tests-4 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-4.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=4;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-4.log 2>&1 &
kubectl exec broker-tests-5 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-5.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=5;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-5.log 2>&1 &
kubectl exec broker-tests-6 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-6.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=6;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-6.log 2>&1 &
kubectl exec broker-tests-7 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-7.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=7;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-7.log 2>&1 &
kubectl exec broker-tests-8 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-8.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=8;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-8.log 2>&1 &
kubectl exec broker-tests-9 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-9.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=9;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-9.log 2>&1 &
kubectl exec broker-tests-10 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-10.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=10;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-10.log 2>&1 &
kubectl exec broker-tests-11 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-11.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=11;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-11.log 2>&1 &
kubectl exec broker-tests-12 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-12.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=12;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-12.log 2>&1 &
kubectl exec broker-tests-13 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-13.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=13;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-13.log 2>&1 &
kubectl exec broker-tests-14 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-14.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=14;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-14.log 2>&1 &
kubectl exec broker-tests-15 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-15.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=15;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-15.log 2>&1 &
kubectl exec broker-tests-16 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-16.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=16;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-16.log 2>&1 &
kubectl exec broker-tests-17 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-17.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=17;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-17.log 2>&1 &
kubectl exec broker-tests-18 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-18.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=18;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-18.log 2>&1 &
kubectl exec broker-tests-19 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-19.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=19;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-19.log 2>&1 &
kubectl exec broker-tests-20 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-20.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=20;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-20.log 2>&1 &
kubectl exec broker-tests-21 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-21.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=21;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-21.log 2>&1 &
kubectl exec broker-tests-22 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-22.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=22;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-22.log 2>&1 &
kubectl exec broker-tests-23 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-23.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=23;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-23.log 2>&1 &
kubectl exec broker-tests-24 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-24.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=24;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-24.log 2>&1 &
kubectl exec broker-tests-25 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-25.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=25;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-25.log 2>&1 &
kubectl exec broker-tests-26 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-26.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=26;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-26.log 2>&1 &
kubectl exec broker-tests-27 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-27.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=27;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-27.log 2>&1 &
kubectl exec broker-tests-28 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-28.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=28;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-28.log 2>&1 &
kubectl exec broker-tests-29 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-29.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=29;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-29.log 2>&1 &
kubectl exec broker-tests-30 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-30.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=30;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-30.log 2>&1 &
kubectl exec broker-tests-31 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-31.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=31;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-31.log 2>&1 &
kubectl exec broker-tests-32 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-32.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=32;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-32.log 2>&1 &
kubectl exec broker-tests-33 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-33.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=33;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-33.log 2>&1 &
kubectl exec broker-tests-34 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-34.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=34;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-34.log 2>&1 &
kubectl exec broker-tests-35 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-35.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=35;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-35.log 2>&1 &
kubectl exec broker-tests-36 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-36.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=36;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-36.log 2>&1 &
kubectl exec broker-tests-37 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-37.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=37;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-37.log 2>&1 &
kubectl exec broker-tests-38 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-38.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=38;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-38.log 2>&1 &
kubectl exec broker-tests-39 -- sh -c 'export TEST_RUN_TEST_NODE_URL=http://broker-tests-39.broker-tests.thingsboard-mqtt-broker.svc.cluster.local:8088;export TEST_RUN_SEQUENTIAL_NUMBER=39;export TEST_RUN_PARALLEL_TESTS_COUNT=40;export TEST_RUN_TEST_ORCHESTRATOR_URL=http://broker-tests-orchestrator-0.broker-tests-orchestrator.thingsboard-mqtt-broker.svc.cluster.local:8088;start-tb-mqtt-broker-performance-tests.sh;' > broker-tests-39.log 2>&1 &
```

**Note:** you can change test run configuration in `test_run_config.json` file inside
the `mqtt-broker-test-run-config.yml` config.

* publisherGroups - list of configured publisher groups
  * id - identifier of the group
  * publishers - number of publishers in the group
  * topicPrefix - topic prefix to which publishers from the group will send messages
  * clientIdPrefix - client id prefix for clients in the group
* subscriberGroups - list of configured subscriber groups
  * id - identifier of the group
  * subscribers - number of subscribers in the group
  * topicFilter - topic filter to which subscribers from the group will subscribe
  * expectedPublisherGroups - expected publisher groups' messages to receive
  * persistentSessionInfo - info about the client (contains `clientType` with values `APPLICATION`/`DEVICE`)
  * clientIdPrefix - client id prefix for clients in the group
* dummyClients - number of dummy clients that will be only connected to the broker
* secondsToRun - seconds to run the test (publishing of messages)
* additionalSecondsToWait - seconds to wait additionally after publishing is finished
* maxMsgsPerPublisherPerSecond - number of messages sent per publisher per second
* publisherQosValue - publish QoS
* subscriberQosValue - subscribe QoS
* minPayloadSize - min payload size that will be generated
* maxConcurrentOperations - max concurrent operations (connects or subscribes) per broker cluster per time
* telemetryKeys - list of telemetry keys used to generate a publishing message